{% extends 'admin/layout_admin.html' %} {# Assumes this layout already includes Tailwind #}

{% block title %}
    Statistiques Wishlists & Consultations - Admin
{% endblock %}

{% block body %}
{# Main container styled like panier_article.html #}
<div class="w-full">
    <div class="mb-8 bg-dark-secondary rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-bold text-white mb-8">Statistiques: Listes d'Envies & Consultations</h2>

        {# --- WISHLIST STATISTICS SECTION --- #}
        <div class="mb-12">
            <h3 class="text-xl font-semibold text-white mb-6 border-b border-gray-700 pb-2">Statistiques des Listes d'Envies</h3>

            {# Table 1: Articles (Skins) per Category in Wishlists #}
            <div class="mb-8">
                <h4 class="text-lg font-medium text-gray-300 mb-4">Articles par Catégorie</h4>
                {% if stats_per_category %}
                    <div class="overflow-x-auto rounded-lg shadow">
                        <table class="min-w-full">
                            <thead class="bg-dark-accent">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Catégorie (Type Skin)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Nombre d'articles uniques</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-700">
                                {% for stat in stats_per_category %}
                                    <tr class="hover:bg-dark-accent transition-colors duration-200">
                                        <td class="px-6 py-4 whitespace-nowrap text-gray-300">{{ stat.category_name | default(stat[0]) }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-accent-blue font-medium">{{ stat.article_count | default(stat[1]) }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-400">Aucune donnée disponible.</p>
                {% endif %}
            </div>

            {# Table 3: Individual Skin Wishlist Counts #}
            <div> {# No margin bottom as it's the last in this section #}
                <h4 class="text-lg font-medium text-gray-300 mb-4">Présence des Skins Individuels</h4>
                {% if skin_wishlist_counts %}
                    <div class="overflow-x-auto rounded-lg shadow">
                        <table class="min-w-full">
                            <thead class="bg-dark-accent">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Skin</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Nombre d'Utilisateurs L'ayant Souhaité</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-700">
                                {% for stat in skin_wishlist_counts %}
                                    <tr class="hover:bg-dark-accent transition-colors duration-200">
                                        <td class="px-6 py-4 whitespace-nowrap text-gray-300">{{ stat.skin_name | default(stat[0]) }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-accent-blue font-medium">{{ stat.user_count | default(stat[1]) }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-400">Aucun skin n'est actuellement dans une liste d'envies.</p>
                {% endif %}
            </div>
        </div>

        {# --- HISTORY STATISTICS SECTION --- #}
        <div>
            <h3 class="text-xl font-semibold text-white mb-6 border-b border-gray-700 pb-2">Statistiques des Consultations (Historique)</h3>

            {# Table 2: Article (Skin) Consultation Count #}
            <div class="mb-8">
                <h4 class="text-lg font-medium text-gray-300 mb-4">Consultations par Article</h4>
                {% if article_click_stats %}
                    <div class="overflow-x-auto rounded-lg shadow">
                        <table class="min-w-full">
                            <thead class="bg-dark-accent">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Article (Skin)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Nombre de Consultations</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-700">
                                {% for stat in article_click_stats %}
                                    <tr class="hover:bg-dark-accent transition-colors duration-200">
                                        <td class="px-6 py-4 whitespace-nowrap text-gray-300">{{ stat.article_name | default(stat[0]) }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-accent-blue font-medium">{{ stat.consultation_count | default(stat[1]) }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-400">Aucune donnée disponible.</p>
                {% endif %}
            </div>

            {# Table 4: Consultations per Category #}
            <div> {# No margin bottom as it's the last in this section #}
                <h4 class="text-lg font-medium text-gray-300 mb-4">Consultations par Catégorie</h4>
                 {% if consultation_category_stats %}
                    <div class="overflow-x-auto rounded-lg shadow">
                        <table class="min-w-full">
                            <thead class="bg-dark-accent">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Catégorie (Type Skin)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Nombre Total de Consultations</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-700">
                                {% for stat in consultation_category_stats %}
                                    <tr class="hover:bg-dark-accent transition-colors duration-200">
                                        <td class="px-6 py-4 whitespace-nowrap text-gray-300">{{ stat.category_name | default(stat[0]) }}</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-accent-blue font-medium">{{ stat.consultation_count | default(stat[1]) }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-gray-400">Aucune donnée disponible.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %} 